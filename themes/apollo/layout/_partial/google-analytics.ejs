<% if (theme.google_analytics){ %>
    <!-- Global Site Tag (gtag.js) - Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=<%= theme.google_analytics %>"></script>
	<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
	<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>

    <script type="text/javascript">
		function gaOptin() {
			console.log("enable tracking");
			
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ 
				(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), 
				m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) 
			})(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); 

			ga('create', '<%= theme.google_analytics %>', 'auto'); 
			ga('set', 'anonymizeIp', true); 
			ga('send', 'pageview');
		}
		
		function gaOptout(){
			console.log("disable tracking");
			var d = new Date;
			d.setTime(d.getTime() + 24*60*60*1000*365);
			document.cookie = "cookieconsent_status=deny;path=/;expires=" + d.toGMTString();
		}
    </script>
	
	<script type="text/javascript">
	window.addEventListener("load", function(){
	window.cookieconsent.initialise({
	  "palette": {
		"popup": {
		  "background": "#252e39"
		},
		"button": {
		  "background": "#14a7d0"
		}
	  },
	  "theme": "classic",
	  "position": "bottom-right",
		onInitialise: function (status) {
		  var type = this.options.type;
		  var didConsent = this.hasConsented();
		  if (status == 'allow' && didConsent) {
			gaOptin();
		  }
		},
	 
		onStatusChange: function(status, chosenBefore) {
		  var type = this.options.type;
		  var didConsent = this.hasConsented();
		  if (status == 'allow' && didConsent) {
			gaOptin();
		  } else {
			gaOptout();
		  }
		},
	  "type": "opt-in",
	  "content": {
		"message": "Der Seitenbetreiber würde gerne Cookies nutzen um die Nutzung der Seite analysieren zu können (Google Analytics)",
		"dismiss": "Cookies nicht zulassen",
		"allow": "Cookies zulassen",
		"link": "Weitere Informationen",
		"href": "https://dmn1k.github.io/impressum/#Datenschutzerklarung"
	  }
	})});
	</script>
    <% } %>